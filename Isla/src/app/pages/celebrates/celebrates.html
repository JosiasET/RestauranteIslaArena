<div class="celebrates-container">
  <!-- Header con imagen del restaurante -->
  <div class="celebrates-header">
    <img src="img/prueba.jpg" alt="Restaurante Isla Arena" class="restaurant-image">
    <div class="header-overlay">
      <h1>¡FESTEJA CON NOSOTROS!</h1>
      <p>Tu día especial merece una celebración especial</p>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="celebrates-content">
    <!-- Sección de introducción -->
    <div class="intro-section">
      <h2>🎂 ¡Celebra tu cumpleaños con nosotros!</h2>
      <p>En Isla Arena queremos hacer tu día aún más especial. Regístrate para el día de tu cumpleaños y ¡te regalamos un delicioso coctel de camarón con bebida! <strong>Deberás presentar tu INE para verificar.</strong></p>
    </div>

    <!-- Formulario de registro -->
    <div class="form-section" *ngIf="!formularioEnviado">
      <div class="form-card">
        <h3>Registra tu información</h3>
        <form (ngSubmit)="onSubmit()" #cumpleForm="ngForm">
          
          <div class="form-group">
            <label for="nombre">Nombre completo *</label>
            <input type="text" id="nombre" name="nombre" 
                   [(ngModel)]="nombre" required 
                   placeholder="Como aparece en tu INE">
          </div>

          <div class="form-group">
            <label for="fechaNacimiento">Fecha de nacimiento *</label>
            <input type="date" id="fechaNacimiento" name="fechaNacimiento"
                   [(ngModel)]="fechaNacimiento" required>
          </div>

          <div class="form-group">
            <label for="telefono">Teléfono *</label>
            <input type="tel" id="telefono" name="telefono"
                   [(ngModel)]="telefono" required
                   placeholder="10 dígitos (9999999999)">
          </div>

          <div class="form-group">
            <label for="fechaReserva">Fecha de tu cumpleaños *</label>
            <input type="date" id="fechaReserva" name="fechaReserva"
                   [(ngModel)]="fechaReserva" required
                   [min]="minDate">
            <small style="color: #666; font-size: 0.8rem; display: block; margin-top: 5px;">
              Selecciona el día exacto de tu cumpleaños
            </small>
          </div>

          <div class="form-group">
            <label for="horaReserva">Hora preferida *</label>
            <select id="horaReserva" name="horaReserva" [(ngModel)]="horaReserva" required>
              <option value="">Selecciona una hora</option>
              <option value="10:00">10:00 AM</option>
              <option value="11:00">11:00 AM</option>
              <option value="12:00">12:00 AM</option>
              <option value="13:00">1:00 PM</option>
              <option value="14:00">2:00 PM</option>
              <option value="15:00">3:00 PM</option>
              <option value="16:00">4:00 PM</option>
              <option value="17:00">5:00 PM</option>
              <option value="18:00">6:00 PM</option>
            </select>
          </div>

          <!-- NUEVO CAMPO: NÚMERO DE PERSONAS -->
          <div class="form-group">
            <label for="personas">Número de personas *</label>
            <select id="personas" name="personas" [(ngModel)]="personas" required>
              <option value="1">1 persona (solo el cumpleañero)</option>
              <option value="2">2 personas</option>
              <option value="3">3 personas</option>
              <option value="4">4 personas</option>
              <option value="5">5 personas</option>
              <option value="6">6 personas</option>
              <option value="7">7 personas</option>
              <option value="8">8 personas</option>
              <option value="9">9 personas</option>
              <option value="10">10 personas</option>
            </select>
            <small style="color: #666; font-size: 0.8rem; display: block; margin-top: 5px;">
              El regalo es solo para el cumpleañero. Este número es para la reservación de mesa.
            </small>
          </div>

          <div class="terms-checkbox">
            <input type="checkbox" id="terms" name="terms" [(ngModel)]="aceptoTerminos" required>
            <label for="terms">Acepto que presentaré mi INE original para verificación al reclamar mi regalo</label>
          </div>

          <button type="submit" class="btn-submit" 
                  [disabled]="!cumpleForm.form.valid || loading">
            {{ loading ? '⏳ Verificando...' : '🎉 ¡Reservar mi regalo!' }}
          </button>

          <!-- Botón para forzar actualización si es necesario -->
          <button type="button" *ngIf="loading" (click)="forzarActualizacion()" 
                  style="margin-top: 10px; background: #f39c12; color: white; border: none; padding: 10px; border-radius: 5px; width: 100%;">
            🔄 Forzar Actualización
          </button>
        </form>
      </div>
    </div>

    <!-- Resultado de la verificación -->
    <div class="result-section" *ngIf="formularioEnviado">
      <div class="result-card" [class.success]="esSuCumpleanios" [class.error]="!esSuCumpleanios">
        
        <div *ngIf="esSuCumpleanios" class="success-content">
          <div class="celebration-animation">🎉🎂🥳</div>
          <h2>¡FELICIDADES {{ nombre | uppercase }}!</h2>
          <p>¡Tu reservación para tu cumpleaños ha sido confirmada!</p>
          
          <div class="reserva-info">
            <div class="reserva-detail">
              <h4>📅 Detalles de tu reservación:</h4>
              <p><strong>Fecha:</strong> {{ formatearFecha(fechaReserva) }}</p>
              <p><strong>Hora:</strong> {{ formatearHora(horaReserva) }}</p>
              <p><strong>Personas:</strong> {{ personas }} persona(s)</p>
              <p><strong>Regalo:</strong> Coctel de camarón + Bebida especial</p>
            </div>
          </div>

          <div class="regalo-info">
            <img src="img/regalo.jpg" alt="Regalo de cumpleaños - Coctel de Camarón" class="regalo-image">
            <div class="regalo-details">
              <h4>🎁 Tu regalo de cumpleaños:</h4>
              <ul>
                <li>🍤 <strong>Coctel de Camarón Premium</strong></li>
                <li>🍹 <strong>Margarita Especial de la Casa</strong></li>
                <li>🎂 <strong>Postre sorpresa</strong></li>
              </ul>
              <p>Delicioso coctel de camarones con salsa especial acompañado de nuestra bebida signature</p>
            </div>
          </div>

          <div class="verificacion-ine">
            <h4>📋 Para reclamar tu regalo:</h4>
            <ol>
              <li>Preséntate en la fecha y hora reservada</li>
              <li>🎫 Muestra esta pantalla al mesero</li>
              <li>🆔 <strong>Presenta tu INE ORIGINAL</strong> para verificación</li>
              <li>¡Disfruta tu regalo de cumpleaños!</li>
            </ol>
          </div>

          <div class="codigo-reserva">
            <p>Tu código de reservación: <strong>{{ codigoReserva }}</strong></p>
          </div>

          <div class="action-buttons">
            <button class="btn-print" (click)="imprimirComprobante()">🖨️ Imprimir comprobante</button>
            <button class="btn-calendar" (click)="agregarACalendario()">📅 Agregar a calendario</button>
            <button class="btn-retry" (click)="reiniciarFormulario()">🔄 Nueva reservación</button>
          </div>
        </div>

      </div>
    </div>

    <!-- Información adicional -->
    <div class="info-section">
      <h3>📋 Términos y condiciones</h3>
      <ul>
        <li>✅ <strong>VERIFICACIÓN DE INE:</strong> Debes presentar identificación oficial ORIGINAL</li>
        <li>✅ Oferta válida solo el día exacto de tu cumpleaños</li>
        <li>✅ Debes respetar la fecha y hora de tu reservación</li>
        <li>✅ Válido para consumo en el restaurante</li>
        <li>✅ El regalo es solo para el cumpleañero</li>
        <li>✅ No acumulable con otras promociones</li>
        <li>✅ Máximo un regalo por persona por año</li>
      </ul>
    </div>
  </div>
</div>